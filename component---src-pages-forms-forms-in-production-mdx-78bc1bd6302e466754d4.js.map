{"version":3,"sources":["webpack:///./src/pages/forms/forms-in-production.mdx"],"names":["layoutProps","MDXContent","props","layout","DefaultLayout","render","this","components","name","Layout","Object","assign","id","parentName","React","Component","_frontmatter"],"mappings":"2RAKA,IAAMA,EAAc,GACCC,E,oBACnB,WAAYC,GAAO,aACjB,cAAMA,IAAN,MACKC,OAASC,IAFG,E,0GAKnBC,OAAA,WAAS,MAIHC,KAAKJ,MAFPK,EAFK,EAELA,WACGL,E,oIAHE,mBAKP,OAAO,kBAAC,SAAD,CAAQM,KAAK,UAAUC,OAAQH,KAAKH,OAAQH,YAAaU,OAAOC,OAAO,GAAIX,EAAaE,GAAQK,WAAYA,GAEjH,wBAAIK,GAAG,uBAAP,uBACA,kBAAC,SAAD,CAAQJ,KAAK,IAAID,WAAYA,GAA7B,aAAuD,kBAAC,SAAD,CAAQC,KAAK,IAAID,WAAYA,EAAYM,WAAW,IAAIX,MAAO,CAClH,KAAQ,6BAD2C,gCAGvD,kBAAC,SAAD,CAAQM,KAAK,IAAID,WAAYA,GAA7B,2FACA,wBAAIK,GAAG,6BAAP,6BACA,kBAAC,SAAD,CAAQJ,KAAK,IAAID,WAAYA,GAA7B,idACA,kBAAC,SAAD,CAAQC,KAAK,IAAID,WAAYA,GAA7B,oWACA,kBAAC,SAAD,CAAQC,KAAK,IAAID,WAAYA,GAA7B,4CACA,kBAAC,SAAD,CAAQC,KAAK,MAAMD,WAAYA,GAAY,kBAAC,SAAD,CAAQC,KAAK,OAAOD,WAAYA,EAAYM,WAAW,MAAMX,MAAO,CAC3G,UAAa,gBAD0B,sOAiB3C,kBAAC,SAAD,CAAQM,KAAK,IAAID,WAAYA,GAA7B,yHAAmK,kBAAC,SAAD,CAAQC,KAAK,aAAaD,WAAYA,EAAYM,WAAW,KAA7D,YAAnK,KAA+P,kBAAC,SAAD,CAAQL,KAAK,aAAaD,WAAYA,EAAYM,WAAW,KAA7D,YAA/P,SAA+V,kBAAC,SAAD,CAAQL,KAAK,aAAaD,WAAYA,EAAYM,WAAW,KAA7D,UAA/V,2CAA+d,kBAAC,SAAD,CAAQL,KAAK,aAAaD,WAAYA,EAAYM,WAAW,KAA7D,YAA/d,QAA8jB,kBAAC,SAAD,CAAQL,KAAK,aAAaD,WAAYA,EAAYM,WAAW,KAA7D,YAA9jB,yIACA,kBAAC,SAAD,CAAQL,KAAK,MAAMD,WAAYA,GAAY,kBAAC,SAAD,CAAQC,KAAK,OAAOD,WAAYA,EAAYM,WAAW,MAAMX,MAAO,CAC3G,UAAa,gBAD0B,sVAa3C,kBAAC,SAAD,CAAQM,KAAK,IAAID,WAAYA,GAA7B,6IAAuL,kBAAC,SAAD,CAAQC,KAAK,aAAaD,WAAYA,EAAYM,WAAW,KAA7D,YAAvL,iCACA,kBAAC,SAAD,CAAQL,KAAK,IAAID,WAAYA,GAA7B,4FACA,kBAAC,SAAD,CAAQC,KAAK,MAAMD,WAAYA,GAAY,kBAAC,SAAD,CAAQC,KAAK,OAAOD,WAAYA,EAAYM,WAAW,MAAMX,MAAO,CAC3G,UAAa,gBAD0B,oZAc3C,kBAAC,SAAD,CAAQM,KAAK,IAAID,WAAYA,GAA7B,wDAAkG,kBAAC,SAAD,CAAQC,KAAK,aAAaD,WAAYA,EAAYM,WAAW,KAA7D,2BAAlG,2CACA,kBAAC,SAAD,CAAQL,KAAK,IAAID,WAAYA,GAA7B,mI,GAtEkCO,IAAMC,WA2EjCC,EAAe","file":"component---src-pages-forms-forms-in-production-mdx-78bc1bd6302e466754d4.js","sourcesContent":["import React from 'react'\nimport { MDXTag } from '@mdx-js/tag'\n\n\nimport DefaultLayout from \"/home/jenkins/workspace/ran-facing-services-tools_master/packages/documentation/src/layouts/SidebarLayout.jsx\";\nconst layoutProps = {};\nexport default class MDXContent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.layout = DefaultLayout;\n  }\n\n  render() {\n    const {\n      components,\n      ...props\n    } = this.props;\n    return <MDXTag name=\"wrapper\" Layout={this.layout} layoutProps={Object.assign({}, layoutProps, props)} components={components}>\n\n      <h1 id=\"forms-in-production\">Forms in production</h1>\n      <MDXTag name=\"p\" components={components}>{`Previous: `}<MDXTag name=\"a\" components={components} parentName=\"p\" props={{\n          \"href\": \"./forms/save-in-progress\"\n        }}>{`Setting up Save in Progress`}</MDXTag></MDXTag>\n      <MDXTag name=\"p\" components={components}>{`Now that you have a form in production, making future changes requires some extra care.`}</MDXTag>\n      <h2 id=\"changing-your-form-schema\">Changing your form schema</h2>\n      <MDXTag name=\"p\" components={components}>{`Once you're in production and you're also using the save in progress functionality, you have a dilemma when you want to change some fields or some validation on your form. Since there are forms that are saved, if you change the structure of the form, the saved data may no longer match and result in confusing validation errors for a user. Similarly, if validation changes, a user might have already gone past that field and won't know how to fix the new error.`}</MDXTag>\n      <MDXTag name=\"p\" components={components}>{`To address this issue, we have the ability to write \"migrations\" for form data. This way, you can update a user's data to match the new structure, as well as move their position in the form back, if they need to adjust something. Migrations are functions, run in a sequence, based on the \"version\" of the form, which is saved along with the form data.`}</MDXTag>\n      <MDXTag name=\"p\" components={components}>{`Migrations go in the form config object:`}</MDXTag>\n      <MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\n          \"className\": \"language-js\"\n        }}>{`const formConfig = {\n   ...\n   version: 1,\n   migrations: [\n     ({ formData, metadata, formId }) => {\n       // do something\n       return {\n         formData,\n         metadata\n       };\n     }\n   ]\n   ...\n};\n`}</MDXTag></MDXTag>\n      <MDXTag name=\"p\" components={components}>{`We typically start at version 0 and increment each time we need to add a migration. Migrations are functions that get `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`formData`}</MDXTag>{`, `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`metadata`}</MDXTag>{`, and `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`formId`}</MDXTag>{` as arguments. And they must return the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`formData`}</MDXTag>{` and `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`metadata`}</MDXTag>{`, with any changes that they have made. For example, here is a migration that the health care application uses to convert an old url:`}</MDXTag>\n      <MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\n          \"className\": \"language-js\"\n        }}>{`({ formData, metadata }) => {\n  const url = metadata.returnUrl || metadata.return_url;\n  let newMetadata = metadata;\n\n  if (url === '/household-information/child-information') {\n    newMetadata = _.set('returnUrl', '/household-information/dependent-information', metadata);\n  }\n\n  return { formData, metadata: newMetadata };\n}\n`}</MDXTag></MDXTag>\n      <MDXTag name=\"p\" components={components}>{`If the current return URL (which is the URL a user will return to when the load a saved form) matches the outdated one, we update it. The `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`formData`}</MDXTag>{` is not changed in this case.`}</MDXTag>\n      <MDXTag name=\"p\" components={components}>{`Another example from the health care application was to fix a bug in our form structure:`}</MDXTag>\n      <MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\n          \"className\": \"language-js\"\n        }}>{`(savedData) => {\n  const newData = savedData;\n  newData.formData = _.unset('isSpanishHispanicLatino', savedData.formData);\n\n  if (typeof _.get('view:demographicCategories.isSpanishHispanicLatino', newData.formData) === 'undefined') {\n    newData.formData = _.set('view:demographicCategories.isSpanishHispanicLatino', false, newData.formData);\n    return newData;\n  }\n\n  return newData;\n}\n`}</MDXTag></MDXTag>\n      <MDXTag name=\"p\" components={components}>{`In this example, we're moving an incorrectly located `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`isSpanishHispanicLatino`}</MDXTag>{` flag and setting it in the right spot.`}</MDXTag>\n      <MDXTag name=\"p\" components={components}>{`Writing migrations is not very common, but you may need to do it if you end up modifying a form that's already in production.`}</MDXTag>\n           </MDXTag>;\n  }\n\n}\nexport const _frontmatter = {};\n    "],"sourceRoot":""}